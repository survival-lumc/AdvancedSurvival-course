---
title: "Schedule"
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: process-schedule
#| echo: false
#| message: false
#| results: false

library(kableExtra)
local_sys <- Sys.getlocale("LC_TIME")
Sys.setlocale("LC_TIME", "English")

df_sched <- readxl::read_xlsx("asa-2024-schedule.xlsx", sheet = 1)
df_sched$start_time <- format(as.POSIXct(df_sched$start_time), format = "%H:%M")
df_sched$finish_time <- format(as.POSIXct(df_sched$finish_time), format = "%H:%M")
df_sched$weekday <- weekdays(as.POSIXct(df_sched$date))
df_sched$date_short <- format(as.POSIXct(df_sched$date), format = "%d/%m")
df_sched$date_lab <- with(df_sched, paste0(weekday, " (", date_short, ")"))

# Set again
Sys.setlocale("LC_TIME", local_sys)
```


```{r}
#| label: schedule-output
#| echo: false

df_sched[, c(
  "start_time",
  "finish_time",
  "instructor",
  "topic"
)] |> 
  kbl(col.names = c("Start", "Finish", "Instructor", "Session title")) |> 
  kable_styling(c("striped", "hover")) |> 
  pack_rows("Monday (26/08)", 1, 11) |> 
  pack_rows("Tuesday (27/08)", 12, 19) |> 
  pack_rows("Wednesday (28/08)", 20, 24) |> 
  pack_rows("Thursday (29/08)", 25, 33) |> 
  pack_rows("Friday (30/08)", 34, 40)
```
